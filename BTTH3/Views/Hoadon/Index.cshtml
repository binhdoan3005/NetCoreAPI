@{
    ViewData["Title"] = "Tính tiền hóa đơn";
}

<h2>Tính tiền hóa đơn</h2>
<form method="post" asp-action="CalculateTotal">
    <div id="items-container">
        <div class="item">
            <label>Tên hàng:</label>
            <input type="text" name="tenHang" required /><br />
            <label>Số lượng:</label>
            <input type="number" name="soLuong" required /><br />
            <label>Đơn giá:</label>
            <input type="number" step="0.01" name="donGia" required /><br />
        </div>
    </div>
    <button type="button" onclick="addItem()">Thêm hàng</button>
    <button type="submit">Tính tổng</button>
</form>

@if (ViewBag.DanhSachHang != null)
{
    <h3>Chi tiết hóa đơn:</h3>
    <table border="1">
        <tr>
            <th>Tên hàng</th>
            <th>Số lượng</th>
            <th>Đơn giá</th>
            <th>Thành tiền</th>
        </tr>
        @foreach (var hang in ViewBag.DanhSachHang)
        {
            <tr>
                <td>@hang.TenHang</td>
                <td>@hang.SoLuong</td>
                <td>@hang.DonGia</td>
                <td>@hang.ThanhTien</td>
            </tr>
        }
    </table>
    <h3>Tổng tiền: @ViewBag.TongTien</h3>
}

<script>
    function addItem() {
        var container = document.getElementById('items-container');
        var newItem = document.createElement('div');
        newItem.classList.add('item');
        newItem.innerHTML = `
            <label>Tên hàng:</label>
            <input type="text" name="tenHang" required /><br />
            <label>Số lượng:</label>
            <input type="number" name="soLuong" required /><br />
            <label>Đơn giá:</label>
            <input type="number" step="0.01" name="donGia" required /><br />
        `;
        container.appendChild(newItem);
    }
</script>